{% extends '/GenericInner.twig' %}
{% import '/Mixins.twig' as html %}

{% if slim.path[1] == 'category' %}
	{% set title = 'Новости - popcornnews' %}
	{% set paginatorMask = '/category/%s/page%%u'|format(slim.path[2]) %}
{% elseif slim.path[1] == 'tag' %}
	{% set title = 'Новости - '~ tag.name|e ~' - popcornnews' %}
	{% set paginatorMask = '/tag/%s/page%%u'|format(slim.path[2]) %}
{% else %}
	{% set title = 'Новости - popcornnews' %}
	{% set paginatorMask = '/news/page%u' %}
{% endif %}


{% block head %}
	<title>{{ title }}</title>
{% endblock %}


{% block content %}

	<div class="b-grid__g8">
		<div class="clearfix">
			<div class="b-grid__g6 b-grid__a">

				{% if slim.path[1] == 'tag' %}
					<h1 style="margin-bottom: 20px;">{{ tag.name|e }}</h1>
				{% endif %}

				<section class="b-large-news">
					<ul class="b-large-news__list">
						{% for post in posts %}
							{% set photo = post.mainImageId.thumb('590x') %}
							<li class="b-large-news__item" style="width:590px;">
								<h2 class="b-large-news__title">
									<a href="/news/{{ post.id }}">{{ post.name|e }}</a>
								</h2>
								<a href="/news/{{ post.id }}" class="b-large-news__img">
									<img alt="" src="{{ photo.url }}" width="{{ photo.width }}" height="{{ photo.height }}">
								</a>

								<p class="b-large-news__text">
									{{ post.announceFriendly }}
								</p>
								<div class="b-large-news__info">
									<a href="/news/{{ post.id }}#comments" class="b-large-news__comments b-comments-status">
										{% if post.comments == 0 %}
											<span class="b-comments-status__title">нет комментариев</span>
										{% else %}
											<span class="b-comments-status__num">{{ post.comments }}</span>
											<span class="b-comments-status__title">{{ post.comments|ruNumber('%s',['комментарий','комментария','комментариев','нет комментариев']) }}</span>
										{% endif %}
									</a>

									<span class="b-single-article__views-title">Просмотров: {{ post.views|number_format(0,'',' ') }}</span>

									{% include '/news/TagsBar.twig' with {'post':post} only %}
								</div>
							</li>
						{% endfor %}
					</ul>
				</section>

				{{
					html.paginator(
						 paginator.pages
						,paginator.active
						,paginatorMask
					)
				}}

			</div>
		</div>
	</div>

{% endblock %}